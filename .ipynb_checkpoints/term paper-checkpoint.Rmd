---
title: \vspace{-1.25cm} \begin{large} Mental Health and the COVID-19 Pandemic \end{large} \vspace{-.75cm}
author: \vspace{-.75cm} \begin{normalsize} Ellice Huang \end{normalsize} \vspace{-.5cm}
date: \vspace{-.5cm} \begin{normalsize} 5 December 2021 \end{normalsize} \vspace{-.5cm}
output:
    pdf_document:
        latex_engine: xelatex
bibliography: references.bib 
nocite: '@*'
mainfont: EB Garamond
fontsize: 12pt
header-includes: 
  - \usepackage{sectsty} \subsubsectionfont{\normalfont\itshape}
  - \usepackage{setspace}\onehalfspacing
---

```{r setup, include=FALSE, message=F}
knitr::opts_chunk$set(echo = TRUE)

library(data.table)
library(plyr)
library(readr)
library(stargazer)
library(ggplot2)
library(dplyr)
library(showtext)
```

### Introduction

In this paper I examine mental health trends in the United States during the COVID-19 pandemic, as well as the heterogeneity of these trends among subgroups including age, sex, and education level. Specifically, I analyze data on the proportion of adults in the United States exhibiting symptoms of anxiety or depressive disorder. I expect to find a positive correlation between the likelihood of experiencing symptoms and the number of daily Covid cases and deaths. I also expect to find that minority groups report worse mental health on average.

### Data and Preliminary Analysis

I use time series data from the CDC Household Pulse Survey, which records characteristics of respondents, including  symptoms of anxiety and depressive disorders, from April 2020 to October 2021 [@mhdata]. The unit of observation is by individual, recorded weekly. I also use data from the *Our World in Data database*, which measures the spread of COVID-19 in the United States in terms of total and daily cases and deaths per capita throughout the pandemic [@owiddata]. My dataset has approximately 2,700,000 observations.

In my model, my outcome variable of interest is a dummy variable indicating 1 if the individual exhibits symptoms of depressive or anxiety disorder (*DEP_ANX*). My independent variables are the 7-day rolling average of daily cases and deaths per capita. I control for race, income level, education level, age, marital status, geographic region, and gender.

In the graph below, I compare the 7-day rolling average of daily Covid cases and deaths per million people with the proportion of adults with symptoms of depression or anxiety, by week (Week 0=23 April 2020). At first glance, there appears to be a positive correlation between daily cases, deaths, and mental health levels.

```{r, eval=F, include=F}
files <- list.files(path="~/Desktop/DEMOG C126/DATA",pattern="*.csv")
#data = do.call(rbind.fill, lapply(files, function(x) read.csv(x, stringsAsFactors = FALSE)))
#df <- ldply(files, read_csv(stringsAsFactors=F))
data = do.call(rbind.fill, lapply(files, fread))

data <- data[,c("SCRAM","WEEK","REGION","EST_ST","EST_MSA","TBIRTH_YEAR",
            "ANXIOUS","WORRY","INTEREST","DOWN","PRESCRIPT",
            "RHISPANIC","RRACE","EEDUC",'MS',
            "EGENID_BIRTH",'GENID_DESCRIBE',"SEXUAL_ORIENTATION",
            "INCOME","WRKLOSSRV","ANYWORK","KINDWORK","EXPNS_DIF",
            "CURFOODSUF","FREEFOOD","MH_SVCS","TENUR","PRIVHLTH","PUBHLTH",
            "THHLD_NUMPER","THHLD_NUMKID","THHLD_NUMADLT","RECVDVACC",
            "DOSESRV","GETVACRV","HADCOVID")]
data <- data[,c(1:4,6:18,22,24,46:50,76,82,106,170:173,206,319:322)]
data <- data[((data$ANXIOUS!=-88)&(data$WORRY!=-88)&(data$DOWN!=-88)&(data$INTEREST!=-88)),]
data <- data[((data$ANXIOUS!=-99)&(data$WORRY!=-99)&(data$DOWN!=-99)&(data$INTEREST!=-99)),]
```

```{r create data, eval=F, include=F}
data$DEP <- as.numeric((data$DOWN>2)&(data$INTEREST>2))
data$ANX <- as.numeric((data$WORRY>2)&(data$ANXIOUS>2))
data$DEP_ANX <- as.numeric((data$DEP==1)|(data$ANX==1))

data$AGE <- 2021-data$TBIRTH_YEAR
data$AGERANGE <- 0
data$AGERANGE<-round_any(data$AGE, 10, f = floor)
for(i in 1:length(data$AGERANGE)) {if(data$AGERANGE[i]==10){data$AGERANGE[i]<-20}}

uspop <- read.csv("~/Desktop/DEMOG C126/uspop.csv", stringsAsFactors = F)
uspop <- uspop[,c("REGION", "DIVISION", "STATE", "NAME", "POPESTIMATE2020")]
data <- merge(x=data, y=uspop[,c('REGION','DIVISION','STATE')], by.x="EST_ST", by.y="STATE",all.x=T)
```

```{r add covid cases, eval=F, include=F}
mentalhealth <- read.csv("~/Desktop/DEMOG C126/mental-health.csv", stringsAsFactors = F)
dates <- unique(mentalhealth$Time.Period.End.Date)[-c(13,23,30,37)]
dates <- c(dates, "9/27/2021", "10/11/2021")
dates <- as.Date((dates), format = "%m/%d/%Y")
x <- data.frame(dates=dates, week=1:39)
data <- merge(x=data, y=x, by.x="WEEK", by.y = "week", all.x=T)

uscovid <- read.csv("~/Desktop/DEMOG C126/owid-covid-data.csv", stringsAsFactors = F)
uscovid$date <- as.Date(uscovid$date)
data <- merge(x = data, y = uscovid[,c("date","new_cases_smoothed", "new_cases_smoothed_per_million",
                                     "new_deaths_smoothed", "new_deaths_smoothed_per_million",
                                     "new_vaccinations_smoothed", "new_vaccinations_smoothed_per_million")], 
                      by.x = "dates", by.y = "date", all.x = TRUE)

data[(data==-88)|(data==-99)] <- NA
data[,c("EGENDER", 'AGENDER', 'RHISPANIC','ANYWORK','EGENID_BIRTH','AGENID_BIRTH','WRKLOSS')]  <- 
  (data[,c("EGENDER", 'AGENDER', 'RHISPANIC','ANYWORK','EGENID_BIRTH','AGENID_BIRTH','WRKLOSS')] - 2 )* -1

write.csv(data, "finaldata.csv", row.names = F)
```

```{r load data, echo=F, include=F}
## START HERE ## 
data <- read.csv("~/Desktop/DATA/finaldata.csv")
data$DEP <- as.numeric((data$DOWN>2)&(data$INTEREST>2))
data$ANX <- as.numeric((data$WORRY>2)&(data$ANXIOUS>2))
data$DEP_ANX <- as.numeric((data$DEP==1)|(data$ANX==1))
data$dates <- as.Date(data$dates)

# one hot encode
data$EST_ST <- as.factor(data$EST_ST)
data$MS <- as.factor(data$MS)
data$THHLD_NUMPER <- as.factor(data$THHLD_NUMPER)
data$RRACE <- as.factor(data$RRACE)
data$EEDUC <- as.factor(data$EEDUC)
data$HLTHSTATUS <- as.factor(data$HLTHSTATUS)
data$REGION.y <- as.factor(data$REGION.y)
data$DIVISION <- as.factor(data$DIVISION)
data$INCOME <- as.factor(data$INCOME)
data$AGERANGE <- as.factor(data$AGERANGE)
data$SEXUAL_ORIENTATION <- as.factor(data$SEXUAL_ORIENTATION)
data$RECVDVACC <-( data$RECVDVACC-2)*-1
data$EGENDER <- as.factor(data$EGENDER)

uscovid <- read.csv("~/Desktop/DATA/uscovid.csv", stringsAsFactors = F)
uscovid[is.na(uscovid)] <- 0 
uscovid$date <- as.Date.character(uscovid$date)
```

```{r, results='asis', eval=F, include=F}
stargazer(data[,c(39:41,101:103,8,10,20,53:55,58:70,81:95)], header=F, 
          title = "Summary Statistics", font.size = "tiny",
          summary.stat = c("n" ,"mean", "median", "min", "max"),
          covariate.labels = c("depression", "anxiety", "DEPANX",
                               "post FL", "post AZ", "post UT",
                               "gender", "hispanic", "employed",
                               "state AZ", "state CA", "State FL", "State UT", "State WA",
                               "race-white", "race-black", "race-asian", "race-other",
                               "educ-<hs", "educ-some hs", "educ- hs", "educ-some col", 
                               "educ-AA", "educ-BA", "educ-grad",
                               "income <25k", "income 25-35k", "income 35-50k",
                               "income 50k-75k", "income 75-100k", "income 100-150k",
                               "income 150-200k", "income >200k",
                               "age <20", "age 20-30","age 30-40", "age 40-50",
                               "age 50-60", "age 60-70", "age 70-80", "age >80"))
```

```{r visualizations 1, eval=F, include=F}
# daily cases and deaths
ggplot(uscovid) + 
  geom_line(aes(x=date,y=new_cases_smoothed_per_million, group=1), color="black") +
  ggtitle("New US Covid Cases Per Million, Rolling Average") +
  labs(x="Date", y="Cases (7 Day Rolling Average)") +
    scale_x_date(date_breaks = "8 weeks", date_labels = "%b-%y")

ggplot(uscovid) + 
  geom_line(aes(x=date,y=new_deaths_smoothed_per_million, group=2), color="blue") +
  ggtitle("New US Covid Deaths Per Million, Rolling Average") +
  labs(x="Date", y="Death (7 Day Rolling Average)") +
    scale_x_date(date_breaks = "8 weeks", date_labels = "%b-%y")
```

``` {r daily covid cases+deaths vs anxiety+dep, echo=F, message=F, warning=F}
font_add_google("EB Garamond")
font_add(family = "Optima", regular = "/Users/ellicehuang/Library/Fonts/optima-cufonfonts/OPTIMA.TTF")
showtext_auto()

par(mfrow=c(1,2))
# daily cases and deaths, weekly

gridExtra::grid.arrange(
  ggplot(data %>% group_by(WEEK) %>% summarise(cases=mean(new_cases_smoothed_per_million),
                                      deaths=mean(new_deaths_smoothed_per_million),
                                      vax=mean(new_vaccinations_smoothed_per_million)))+
  geom_line(aes(x=WEEK, y=cases), col="#4B85EB") +
  geom_line(aes(x=WEEK, y=deaths*100), col="#4BBB6D") +
  ggtitle("Daily US Covid Cases and Deaths Per Million, 7 Day Rolling Average") +
  labs(x="Week", y="Cases") +
  scale_x_continuous(n.breaks = 20) +
  scale_y_continuous(sec.axis = sec_axis(~./100, name="Deaths"))
  + theme_light()
  + theme(text = element_text(family = "Optima", size=8)) +
  annotate("text", x = 2.8, y = 585, label = "Deaths", size=2.5, fontface="italic") +
  annotate("text", x = 1.5, y = 200, label = "Cases", size=2.5, fontface="italic")
  ,
  ggplot(data %>% group_by(WEEK) %>% summarise(DEP_ANX=mean(DEP_ANX),
                                      ANX=mean(ANX),
                                      DEP=mean(DEP)))+
  geom_line(aes(x=WEEK, y=DEP_ANX), col='purple') +
  # geom_line(aes(x=WEEK, y=ANX),col='red') +
  # geom_line(aes(x=WEEK, y=DEP),col='blue') +
  ggtitle("Proportion of Adults with Depression or Anxiety") +
  labs(x="Week", y="Proportion") +
  scale_x_continuous(n.breaks = 20) +
  scale_y_continuous(sec.axis = sec_axis(~.*1, name=""))
  + theme_light()
  + theme(text = element_text(family = "Optima", size=8)) 
  ,
  ncol=1, nrow=3
)
```

The figure below visualizes the heterogeneity of trends of the proportion of adults exhibiting depression or anxiety symptoms among subgroups. It appears that individuals reporting higher education levels, higher yearly income, or higher age have better mental health on average. Individuals that identify as Asian or White have the lowest proportions, as well as married and widowed individuals. Males have a significantly lower proportion than women. 
\

```{r visualizations by control vars, warning=F, echo=F}
a <- data[,c('WEEK','EGENDER','AGERANGE','INCOME','WRKLOSS','ANYWORK','RRACE',
                'EEDUC','RHISPANIC','THHLD_NUMPER','MS',
                'REGION.y','DIVISION','DEP','ANX','DEP_ANX')]

gridExtra::grid.arrange(
  
  ggplot(aggregate(a, by=list(a$WEEK, a$EGENDER), FUN=mean)) +
    geom_line(aes(x=Group.1, y=DEP_ANX, group=Group.2, color=Group.2), lwd=0.2) +
    ggtitle("Proportion of Adults with Depression or Anxiety, by Gender") +
    labs(x="Week", y="Proportion", col='') +
    theme_light() +
    theme(text = element_text(family = "Optima", size=5.5),
          legend.key.size = unit(0.5, 'lines'),
          legend.text=element_text(size=6),
          legend.margin=margin(1,1,1,1, unit="pt"),
          legend.box.margin=margin(1,1,1,1, unit="pt")) +
    scale_x_continuous(n.breaks = 10) +
    scale_color_hue(labels = c('F','M')) ,
  
  ggplot(aggregate(a, by=list(a$WEEK, a$RRACE), FUN=mean)) +
    geom_line(aes(x=Group.1, y=DEP_ANX, group=Group.2, color=Group.2), lwd=0.2) +
    ggtitle("Proportion of Adults with Depression or Anxiety, by Race") +
    labs(x="Week", y="Proportion", col='') +
    scale_color_hue(labels = c("white", "black", "asian", "other")) +
    theme_light() +
    theme(text = element_text(family = "Optima", size=5.5),
          legend.key.size = unit(0.5, 'lines'),
          legend.text=element_text(size=6),
          legend.margin=margin(1,1,1,1, unit="pt"),
          legend.box.margin=margin(1,1,1,1, unit="pt")) +
    scale_x_continuous(n.breaks = 10) ,
  
  ggplot(aggregate(a, by=list(a$WEEK, a$INCOME), FUN=mean)) +
    geom_line(aes(x=Group.1, y=DEP_ANX, group=Group.2, color=Group.2), lwd=0.2) +
    ggtitle("Proportion of Adults with Depression or Anxiety, by Income") +
    labs(x="Week", y="Proportion", col='') +
    scale_color_hue(labels=c("<25k", "25-35k", "35-50k",
                               "50k-75k", "75-100k", "100-150k",
                               "150-200k", ">200k")) +
    theme_light() +
    theme(text = element_text(family = "Optima", size=5.5),
          legend.key.size = unit(0.5, 'lines'),
          legend.text=element_text(size=6),
          legend.margin=margin(1,1,1,1, unit="pt"),
          legend.box.margin=margin(1,1,1,1, unit="pt")) +
    scale_x_continuous(n.breaks = 10) ,
  
  ggplot(aggregate(a, by=list(a$WEEK, a$AGERANGE), FUN=mean)) +
    geom_line(aes(x=Group.1, y=DEP_ANX, group=Group.2, color=Group.2), lwd=0.2) +
    ggtitle("Proportion of Adults with Depression or Anxiety, by Age") +
    labs(x="Week", y="Proportion", col='') +
    scale_color_hue(labels=c("<20", "20-30","30-40", "40-50",
                               "50-60", "60-70", "70-80", ">80")) +
    theme_light() +
    theme(text = element_text(family = "Optima", size=5.5),
          legend.key.size = unit(0.5, 'lines'),
          legend.text=element_text(size=6),
          legend.margin=margin(1,1,1,1, unit="pt"),
          legend.box.margin=margin(1,1,1,1, unit="pt")) +
    scale_x_continuous(n.breaks = 10) ,
  
  ggplot(aggregate(a, by=list(a$WEEK, a$EEDUC), FUN=mean)) +
    geom_line(aes(x=Group.1, y=DEP_ANX, group=Group.2, color=Group.2), lwd=0.2) +
    ggtitle("Proportion of Adults with Depression or Anxiety, by Education") +
    labs(x="Week", y="Proportion", col='') +
    scale_color_hue(labels=c("<hs", "some hs", " hs", "some col", 
                               "AA", "BA", "grad")) +
    theme_light() +
    theme(text = element_text(family = "Optima", size=5.5),
          legend.key.size = unit(0.5, 'lines'),
          legend.text=element_text(size=6),
          legend.margin=margin(1,1,1,1, unit="pt"),
          legend.box.margin=margin(1,1,1,1, unit="pt")) +
    scale_x_continuous(n.breaks = 10) ,
  
  ggplot(aggregate(a, by=list(a$WEEK, a$REGION.y), FUN=mean)) +
    geom_line(aes(x=Group.1, y=DEP_ANX, group=Group.2, color=Group.2), lwd=0.2) +
    ggtitle("Proportion of Adults with Depression or Anxiety, by Geographic Region") +
    labs(x="Week", y="Proportion", col='') +
    theme_light() +
    theme(text = element_text(family = "Optima", size=5.5),
          legend.key.size = unit(0.5, 'lines'),
          legend.text=element_text(size=6),
          legend.margin=margin(1,1,1,1, unit="pt"),
          legend.box.margin=margin(1,1,1,1, unit="pt")) +
    scale_x_continuous(n.breaks = 10) +
    scale_color_hue(labels = c("ne", "mw", "s", "w")) ,
  
  ggplot(aggregate(a, by=list(a$WEEK, a$MS), FUN=mean)) +
    geom_line(aes(x=Group.1, y=DEP_ANX, group=Group.2, color=Group.2), lwd=0.2) +
    ggtitle("Proportion of Adults with Depression or Anxiety, by Marital Status") +
    labs(x="Week", y="Proportion", col='') +
    scale_color_hue(labels=c("married","widowed","divorced","separated","never"))+
    theme_light() +
    theme(text = element_text(family = "Optima", size=5.5),
          legend.key.size = unit(0.5, 'lines'),
          legend.text=element_text(size=6),
          legend.margin=margin(1,1,1,1, unit="pt"),
          legend.box.margin=margin(1,1,1,1, unit="pt")) +
    scale_x_continuous(n.breaks = 10) ,
  ncol=2
)  

```

### Results

To test my hypothesis, I estimate two logistic regressions with the likelihood of having symptoms of depression and anxiety as the dependent variable. In Table 1 below, regression (1) uses the 7-day rolling average of new daily Covid deaths as an independent variable, and regression (2) uses the 7-day rolling average of new daily Covid cases as an independent variable. On average, each additional increase of daily Covid deaths is associated with a 3.3% (exp(0.033)-1) increase in the odds of experiencing depression or anxiety, and 0.1% for Covid cases. 

```{r regressions, results='asis', echo=F}
# GLM LOGIT MODEL
reg1 <- glm(DEP_ANX ~ new_deaths_smoothed_per_million+
             EGENDER+MS+INCOME+AGERANGE+RHISPANIC+RRACE+EEDUC+REGION.y, data=data,family = 'binomial')
# reg1.1 <- glm(DEP ~ new_deaths_smoothed_per_million+
#              EGENDER+MS+INCOME+AGERANGE+RHISPANIC+RRACE+EEDUC+REGION.y, data=data,family = 'binomial')
# reg1.2 <- glm(ANX ~ new_deaths_smoothed_per_million+
#              EGENDER+MS+INCOME+AGERANGE+RHISPANIC+RRACE+EEDUC+REGION.y, data=data,family = 'binomial')

reg2 <- glm(DEP_ANX ~ new_cases_smoothed_per_million+
             EGENDER+MS+INCOME+AGERANGE+RHISPANIC+RRACE+EEDUC+REGION.y, data=data,family = 'binomial')
# reg2.1 <- glm(DEP ~ new_cases_smoothed_per_million+
#              EGENDER+MS+INCOME+AGERANGE+RHISPANIC+RRACE+EEDUC+REGION.y, data=data,family = 'binomial')
# reg2.2 <- glm(ANX ~ new_cases_smoothed_per_million+
#              EGENDER+MS+INCOME+AGERANGE+RHISPANIC+RRACE+EEDUC+REGION.y, data=data,family = 'binomial')

reg3 <- glm(DEP_ANX ~ new_vaccinations_smoothed_per_million+
             EGENDER+MS+INCOME+AGERANGE+RHISPANIC+RRACE+EEDUC+REGION.y, data=data,family = 'binomial')
# reg3.1 <- glm(DEP ~ new_vaccinations_smoothed_per_million+
#              EGENDER+MS+INCOME+AGERANGE+RHISPANIC+RRACE+EEDUC+REGION.y, data=data,family = 'binomial')
# reg3.2 <- glm(ANX ~ new_vaccinations_smoothed_per_million+
#              EGENDER+MS+INCOME+AGERANGE+RHISPANIC+RRACE+EEDUC+REGION.y, data=data,family = 'binomial')


# oddsratios <- cbind(as.data.frame(exp(coef(reg1))),as.data.frame(exp(coef(reg2))))
# stargazer(oddsratios,summary=F, column.sep.width = "1pt",  single.row = TRUE)

stargazer(reg1, reg2,
          summary = F, font.size = 'scriptsize',
          column.sep.width = "1pt",  single.row = T,
          header=F, title = 'Logistic Regression Results',
          dep.var.labels = "Proportion Adults with Depression or Anxiety",
          no.space = T,
          covariate.labels = c("deaths","cases","gender-male",
                               "MS-widowed","MS-divorced","MS-separated","MS-never",
                               "income 25-35k", "income 35-50k",
                               "income 50-75k", "income 75-100k", "income 100-150k",
                               "income 150-200k", "income >200k",
                               "age 20-30","age 30-40", "age 40-50",
                               "age 50-60", "age 60-70", "age 70-80", "age >80",
                               "nonhispanic",
                               "race-black", "race-asian", "race-other",
                               "educ-some hs", "educ- hs", "educ-some col",
                               "educ-AA", "educ-BA", "educ-grad",
                               "region-mw", "region-s", "region-w"))
```

\newpage

Regarding the heterogeneity of trends among subgroups, I observe the following:

* Reporting male is associated with a 26.1% reduction in odds of experiencing depression or anxiety compared to reporting female. 
* Compared to married respondents, reporting "separated" is associated with the highest increase in odds of worse mental health (55%), followed by "divorced" (29%), "never married" (23%), and "widowed" (16%).
* Respondents with higher income and higher age are associated with a significant reduction in odds of experiencing worse mental health. Reporting a 200k+ yearly income is associated with a 70% reduction of odds of worse mental health, and being over 70 years old with a 80% reduction.
* Nonhispanic respondents are associated with a 17% decrease of odds of worse mental health compared to hispanic respondents.
* Compared to white respondents, reporting "asian" is associated with a 18% *increase* of odds of worse mental health, "black" with a 18% *reduction* in odds, and "other" respondents with a 6% *reduction* in odds.
* Reporting higher education is associated with a decrease in odds of worse mental health. In particular, those having a college degree (AA, BA, graduate) are associated with a 17-20% decrease in odds compared to those without highschool education.
* Geographic regions do not have significantly different mental health levels.

### Discussion

As expected, increased daily Covid deaths is associated with a 3.3% increase in odds of experiencing anxiety and depression. However, increased daily Covid cases is associated with a much smaller 0.1% increase. This may be because the effect of Covid cases is variable across local geographical regions: different regions experienced waves of cases at different times. By contrast, Covid deaths may have been more broadcasted across media, affecting the general public more jointly. Further analysis among smaller regions within the US may yield more accurate estimates of the association between Covid deaths or cases and mental health.

In addition, reporting male, higher age, higher education, higher income, or hispanic is associated with much lower odds of experiencing anxiety and depression, as expected. However, the data shows that black respondents are associated with the lowest odds of depression of anxiety, which disproves my hypothesis that minority racial groups are associated with higher odds of depression of anxiety. 

\newpage

Given these findings, it is crucial for US policy-makers to not only pursue policies that effectively fight the spread of Covid, but also bridge the mental health gap for minority groups. Indeed, this gap was likely a preexisting trend exacerbated by the pandemic. Policy-makers should consider encouraging lower education individuals to pursue higher education, for example by creating accessible, low-cost academic programs and scholarships. In addition, policy-makers should give minorities greater access to mental health services, for example by expanding telehealth programs and subsidizing costs of services.

Regarding global implications, a possible extension of my study is to examine temporal trends of mental health across different countries during the COVID-19 pandemic. By comparing two demographically similar countries that suffered Covid outbreaks at different times (for example, the United States and Canada), it may be possible to estimate the causal effect of the COVID-19 pandemic on mental health [@Alfano_2020]. For instance, while stay-at-home orders are effective in fighting the spread of Covid [@Friedson_2020], they may have adverse effects on the population's mental health [@Xu_2020]. These findings will push policy-makers to take mental health into consideration when desinging policies in future global emergencies and economic downturns.

\newpage

### References
